<div class="card">
  <div class="card-header">
    <h5>{{if model.isNew 'Activiteit aanmaken' 'Activiteit wijzigen'}}</h5>
  </div>
  <div class="card-body">
    <form {{action "submit" on="submit"}}>

      {{#if model.form.hasResponses}}
        <div class="alert alert-danger">
          Je kunt niet alles meer aanpassen, omdat er al reacties zijn.
        </div>
      {{/if}}
      {{model-form/text-input     model=model property="title"       label='Titel'      required=true}}
      {{model-form/md-input       model=model property="description" label='Omschrijving' required=true inputIdentifier="activity-form-content"}}
      {{model-form/select-input   model=model property="category"    label='Categorie'  required=true options=activityCategoryOptions}}
      {{model-form/file-input     model=model property="coverPhoto"  label='Coverfoto' fileLoaded=(action "coverPhotoLoaded")}}
      {{model-form/text-input     model=model property="location"    label='Locatie'   required=true}}
      {{model-form/text-input     model=model property="price"       label='Prijs'     required=true type="number" step="0.01" disabled=model.form.hasResponses}}
      {{model-form/datetime-input model=model property="startTime"   label='Begintijd' required=true}}
      {{model-form/datetime-input model=model property="endTime"     label='Eindtijd'  required=true}}
      {{model-form/checkbox-input model=model property='publiclyVisible'  label='Zichtbaar voor externen'}}

      {{#if model.publiclyVisible}}
        <div class="alert alert-warning">
          Een activiteit die zichtbaar is voor niet-leden is zichtbaar op de externe website. Zet dit vinkje alleen aan met toestemming van het Algemeen Bestuur.
        </div>
      {{/if}}

      <div class="row">
        <div class="col-md-12">
          <div class="form-group row">
            <label class="col-md-2 form-control-label">Namens groep of commissie</label>

            <div class="col-sm-10">
              {{#power-select
                options=groups
                onchange=(action (mut model.group))
                selected=model.group
                searchField="name" as |group|}}
                {{group.name}}
              {{/power-select}}

              {{form-control-feedback (get model.errors property)}}
            </div>
          </div>
        </div>
      </div>

      {{model-form/checkbox-input model=this property="activityHasForm" label='Deze activiteit heeft een inschrijflijst' disabled=model.form.hasResponses}}

      {{#if (and model.publiclyVisible activityHasForm)}}
        <div class="alert alert-warning">
          Inschrijflijsten zijn alleen zichtbaar voor leden. Voor extern gebruik van formulieren kan gebruik gemaakt worden van Google Forms. Plaats dan de link in de beschrijving van je activiteit.
        </div>
      {{/if}}

      <div class="row">
        <div class="col-sm-10 offset-sm-2">
          {{#each model.form.errors.base as |error|}}
            <div class="text-danger form-submit-error">{{error.message}}</div>
          {{/each}}
        </div>
      </div>

      {{#model-form/form-actions errors=combinedErrors errorMessage=errorMessage}}
        {{#link-to "activities.show" model class="btn btn-default"}}Annuleren{{/link-to}}
      {{/model-form/form-actions}}
    </form>
  </div>
</div>

{{#if activityHasForm}}
  <div class="card">
    <div class="card-header">
      <h5>Inschrijflijst</h5>
    </div>
    <div class="card-block p-3">
      {{form/form-form model.form}}
    </div>
  </div>
{{/if}}
